<?xml version="1.0" encoding="UTF-8"?><mappingRoot domainID="com.ibm.msl.mapping.xml" domainIDExtension="mb" mainMap="true" targetNamespace="default" version="8.0.4.0" xmlns="http://www.ibm.com/2008/ccl/Mapping" xmlns:map="default">
    <input path="/EXAT.xsd" var="var"/>
    <output path="db:table(/mssql.dbm,DESK,dbo,CARD_TRANSACTIONS)" var="CARDTRANSACTIONS2"/>
    <namespaces>
        <namespace kind="extension" prefix="fn" uri="http://www.w3.org/2005/xpath-functions"/>
    </namespaces>
    <generation engine="xquery"/>
    <mappingDeclaration name="CARD_TRANSACTIONS">
        <input namespace="http://www.quantiguous.com/dfdl/vplus/EXATFormat" path="$var/mb:msg(EXAT,assembly,DFDL,Properties)" var="MessageAssembly"/>
        <output path="$CARDTRANSACTIONS2/db:update(fn:false(),fn:true(),db:where('ACCOUNT = ?1 AND AUTHCODE = ?2 AND TXN_DATE = ?3','?1'=$body/ACCOUNT,'?2'=$body/AUTHCODE,'?3'=$body/TXN_DATE),ID,ORG,ACCOUNT,REC_NO,LOGO,TXN_TYPE,TXN_DATE,MT_TYPE,TXN_CODE,AMOUNT,F1,UNIT_PRICE,F2,BATCH_DT,POST_DATE,QUANTITY,AUTHCODE,MT_SI_ORG,MT_SI_NBR,PLAN_NO,SALESPERSO,TKT_NBR,PURCH_NUM,PMT_REF_NO,ITEM_NBR,REF_NBR,MERCHANT,CITY,COUNTRY,PLAN_OPEN,INPUT_SRC,MULT_REF,FSP,FSP_PRG_NO,MERCH_ORG,MERCH_STOR,CAT_CODE,PROD_GRP,SKU_NBR,LOGIC_MOD,RPT_DESC,GL_SOURCE,DEPT,SOURCE,BATCH_NO,BATCH_SEQ,PLAN_SEQ,SORT_PRIOR,POST_FLAG,VISATRANID,ICHNG_FEE,QUAL_ID,CARD_NBR,CARD_SEQ,CARD_BLK,INS_PROD,ACT_TERM,FOREX_CD,RELPMT_AMT,F3,ORIG_PYMT,F4,STMT_FLAG,SOU_TXN_DT,C_CITY,C_COUNTRY,SOU_TXN_AM,CURRY_CODE,C_ARN,C_AQR_BIN,C_RECORD_TYPE,CREATED_AT,UPDATED_AT,TXN_STATE)" var="dbupdate"/>
        <foreach>
            <input path="$MessageAssembly/EXAT/body" var="body"/>
            <output path="$dbupdate/."/>
            <update ref="dbupdate">
                <input path="$body/."/>
                <output path="."/>
                <move automap="true">
                    <input path="ORG"/>
                    <output path="ORG"/>
                </move>
                <move automap="true">
                    <input path="ACCOUNT"/>
                    <output path="ACCOUNT"/>
                </move>
                <move automap="true">
                    <input path="LOGO"/>
                    <output path="LOGO"/>
                </move>
                <move automap="true">
                    <input path="TXN_DATE"/>
                    <output path="TXN_DATE"/>
                </move>
                <move automap="true">
                    <input path="AMOUNT"/>
                    <output path="AMOUNT"/>
                </move>
                <move automap="true">
                    <input path="AUTHCODE"/>
                    <output path="AUTHCODE"/>
                </move>
                <move automap="true">
                    <input path="MT_SI_ORG"/>
                    <output path="MT_SI_ORG"/>
                </move>
                <move automap="true">
                    <input path="MT_SI_NBR"/>
                    <output path="MT_SI_NBR"/>
                </move>
                <move automap="true">
                    <input path="PLAN"/>
                    <output path="PLAN_NO"/>
                </move>
                <move automap="true">
                    <input path="MERCHANT"/>
                    <output path="MERCHANT"/>
                </move>
                <move automap="true">
                    <input path="CITY"/>
                    <output path="CITY"/>
                </move>
                <move>
                    <input path="TYPE"/>
                    <output path="TXN_TYPE"/>
                </move>
                <function ref="fn:current-dateTime">
                    <output path="CREATED_AT"/>
                </function>
                <function ref="fn:current-dateTime">
                    <output path="UPDATED_AT"/>
                </function>
            </update>
        </foreach>
    </mappingDeclaration>
</mappingRoot>